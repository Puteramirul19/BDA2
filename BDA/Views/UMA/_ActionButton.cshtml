@model BDA.ViewModel.UMAViewModel

<div class="form-actions" style="border-top: 1px solid #e4e8ea; padding-top: 20px; margin-top: 20px;">
    <div class="d-flex justify-content-end">
        <button type="button" class="btn btn-secondary mr-2" onclick="window.history.back();">Back</button>

        <!-- Create Stage Buttons -->
        @if (Model.Status == "Draft" || Model.Status == null)
        {
            <button type="button" class="btn btn-outline-primary mr-2" onclick="saveUMA('Draft')">Save as Draft</button>
            <button type="button" class="btn btn-primary" onclick="saveUMA('Submit')">Submit</button>
        }

        <!-- Submit to Bank Stage -->
        @if (Model.Status == "Submitted")
        {
            <button type="button" class="btn btn-primary" onclick="processUMA()">Submit to Bank</button>
        }

        <!-- Submit to ANM Stage -->
        @if (Model.Status == "Processed")
        {
            <button type="button" class="btn btn-primary" onclick="receiveUMA()">Submit to ANM</button>
        }

        <!-- Incoming Payment Stage -->
        @if (Model.Status == "SubmittedToANM")
        {
            <button type="button" class="btn btn-primary" onclick="confirmUMA()">Confirm Payment</button>
        }

        <!-- Complete Stage -->
        @if (Model.Status == "Received")
        {
            <button type="button" class="btn btn-success" onclick="completeUMA()">Complete</button>
        }
    </div>
</div>

<script>
    function saveUMA(status) {
        $("#Status").val(status);
        $("#formCreateUMA").submit();
    }

    function processUMA() {
        $("#Status").val("Processed");
        $("#UserAction").val("SubmitToBank");
        $("#formProcessUMA").submit();
    }

    function receiveUMA() {
        $("#Status").val("SubmittedToANM");
        $("#UserAction").val("SubmitToANM");
        $("#formReceiveUMA").submit();
    }

    function confirmUMA() {
        $("#Status").val("Received");
        $("#UserAction").val("PaymentReceived");
        $("#formConfirmUMA").submit();
    }

    function completeUMA() {
        $("#Status").val("Complete");
        $("#UserAction").val("Complete");
        $("#formCompleteUMA").submit();
    }
</script>